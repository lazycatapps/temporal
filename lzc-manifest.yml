# ========== åº”ç”¨åŸºæœ¬ä¿¡æ¯ ==========
name: Temporal
# åº”ç”¨å”¯ä¸€ID,å…¨çƒå”¯ä¸€æ ‡è¯†
package: cloud.lazycat.app.liu.temporal
# åº”ç”¨ç‰ˆæœ¬å·,å¯¹åº” Temporal Server ç‰ˆæœ¬
version: 1.29.0
keyword: temporal,workflow,orchestration
description: Temporal æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼å·¥ä½œæµç¼–æ’å¹³å°,ç”¨äºæ„å»ºå¯é ã€å¯æ‰©å±•çš„åº”ç”¨ç¨‹åºã€‚å®ƒæä¾›äº†å·¥ä½œæµå¼•æ“ã€ä»»åŠ¡é˜Ÿåˆ—å’Œ Web UI ç®¡ç†ç•Œé¢,æ”¯æŒé•¿æ—¶é—´è¿è¡Œçš„ä¸šåŠ¡æµç¨‹ã€å¾®æœåŠ¡ç¼–æ’å’Œäº‹ä»¶é©±åŠ¨æ¶æ„ã€‚

# è½¯ä»¶åç§°,ä¼šæ˜¾ç¤ºåœ¨å¯åŠ¨å™¨ä¹‹ç±»çš„åœ°æ–¹
locales:
  zh:
    name: Temporal å·¥ä½œæµå¼•æ“
    description: |
      ## Temporal å·¥ä½œæµå¼•æ“

      Temporal å®˜æ–¹ç½‘ç«™ï¼šhttps://temporal.io/

      Temporal æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼å·¥ä½œæµç¼–æ’å¹³å°ï¼Œä¸“ä¸ºæ„å»ºå¯é ã€å¯æ‰©å±•çš„åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºè€Œè®¾è®¡ã€‚å®ƒé€šè¿‡å·¥ä½œæµï¼ˆWorkflowï¼‰å’Œæ´»åŠ¨ï¼ˆActivityï¼‰çš„æ¦‚å¿µï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾å®ç°å¤æ‚çš„ä¸šåŠ¡æµç¨‹ç¼–æ’ã€‚

      æœ¬åº”ç”¨åœ¨ LazyCat å¹³å°ä¸Šéƒ¨ç½²äº†å®Œæ•´çš„ Temporal æœåŠ¡ï¼ŒåŒ…æ‹¬ Temporal Serverã€Web UIã€PostgreSQL æ•°æ®åº“å’Œç®¡ç†å·¥å…·ï¼Œå¼€ç®±å³ç”¨ã€‚

      ## æ ¸å¿ƒç‰¹æ€§

      - âœ… **è‡ªåŠ¨é‡è¯•æœºåˆ¶** - æ´»åŠ¨å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•ï¼Œæ— éœ€æ‰‹åŠ¨ç¼–å†™é‡è¯•é€»è¾‘
      - âœ… **æ‰§è¡Œå®Œæ•´æ€§ä¿è¯** - å³ä½¿æœåŠ¡é‡å¯ï¼Œå·¥ä½œæµä¹Ÿä¼šä»ä¸­æ–­å¤„ç»§ç»­æ‰§è¡Œ
      - âœ… **é•¿æ—¶é—´è¿è¡Œæ”¯æŒ** - æ”¯æŒä»å‡ ç§’åˆ°å‡ å¹´çš„å·¥ä½œæµæ‰§è¡Œæ—¶é—´
      - âœ… **åˆ†å¸ƒå¼äº‹åŠ¡** - æä¾›è¡¥å¿äº‹åŠ¡ï¼ˆSagaï¼‰æ¨¡å¼ï¼Œç®€åŒ–åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†
      - âœ… **å¯è§‚æµ‹æ€§** - å†…ç½® Web UI æŸ¥çœ‹å·¥ä½œæµæ‰§è¡Œå†å²å’ŒçŠ¶æ€
      - âœ… **æ°´å¹³æ‰©å±•** - Worker å¯ä»¥æ°´å¹³æ‰©å±•ä»¥æé«˜å¤„ç†èƒ½åŠ›

      ## ä¸»è¦ç»„ä»¶

      - **Temporal Server** - å·¥ä½œæµå¼•æ“æ ¸å¿ƒæœåŠ¡ï¼ˆgRPC ç«¯å£ 7233ï¼‰
      - **Web UI** - å·¥ä½œæµç®¡ç†å’Œç›‘æ§ç•Œé¢ï¼ˆé€šè¿‡åº”ç”¨åŸŸåè®¿é—®ï¼‰
      - **PostgreSQL** - æŒä¹…åŒ–å­˜å‚¨å·¥ä½œæµçŠ¶æ€å’Œå†å²
      - **Admin Tools** - å‘½ä»¤è¡Œç®¡ç†å·¥å…·

      ## ä½¿ç”¨æ–¹æ³•

      ### 1. è®¿é—® Web UI

      é€šè¿‡åº”ç”¨åŸŸåç›´æ¥è®¿é—® Temporal Web UIï¼ŒæŸ¥çœ‹å’Œç®¡ç†å·¥ä½œæµæ‰§è¡Œï¼š
      ```
      https://temporal.${BOXNAME}.heiyu.space
      ```

      ### 2. è¿æ¥ Temporal æœåŠ¡

      åœ¨ä½ çš„åº”ç”¨ä¸­ä½¿ç”¨ Temporal Go SDK è¿æ¥åˆ°æœåŠ¡ï¼š
      ```go
      import "go.temporal.io/sdk/client"

      c, err := client.Dial(client.Options{
          HostPort: "temporal.${BOXNAME}.heiyu.space:7233",
      })
      ```

      ### 3. è¿è¡Œç¤ºä¾‹é¡¹ç›®

      æœ¬ä»“åº“åŒ…å«ä¸€ä¸ªå®Œæ•´çš„è®¢å•å¤„ç†ç³»ç»Ÿç¤ºä¾‹ï¼ˆorder-demoï¼‰ï¼Œæ¼”ç¤ºäº†ï¼š
      - 5 æ­¥è®¢å•å¤„ç†æµç¨‹ï¼ˆéªŒè¯ â†’ åº“å­˜ â†’ æ”¯ä»˜ â†’ å‘è´§ â†’ é€šçŸ¥ï¼‰
      - è‡ªåŠ¨é‡è¯•æœºåˆ¶
      - è¡¥å¿äº‹åŠ¡ï¼ˆSaga æ¨¡å¼ï¼‰
      - å®¹é”™å¤„ç†

      å¯åŠ¨ Workerï¼š
      ```bash
      cd order-demo
      go run worker/main.go -temporal-address temporal.${BOXNAME}.heiyu.space:7233
      ```

      è¿è¡Œå®¢æˆ·ç«¯ï¼š
      ```bash
      go run client/main.go -temporal-address temporal.${BOXNAME}.heiyu.space:7233
      ```

      ## é€‚ç”¨åœºæ™¯

      - ğŸ“¦ **è®¢å•å¤„ç†** - ç”µå•†è®¢å•ä»åˆ›å»ºåˆ°å®Œæˆçš„å…¨æµç¨‹ç¼–æ’
      - ğŸ’° **æ”¯ä»˜å¤„ç†** - å¤æ‚çš„æ”¯ä»˜æµç¨‹å’Œé€€æ¬¾è¡¥å¿é€»è¾‘
      - ğŸ“Š **æ•°æ®å¤„ç†** - ETL æµç¨‹ã€æ‰¹é‡æ•°æ®å¤„ç†ä»»åŠ¡
      - ğŸ”„ **å®šæ—¶ä»»åŠ¡** - å¤æ‚çš„å®šæ—¶ä»»åŠ¡è°ƒåº¦å’Œé‡è¯•
      - ğŸ¯ **å¾®æœåŠ¡ç¼–æ’** - è·¨å¤šä¸ªå¾®æœåŠ¡çš„ä¸šåŠ¡æµç¨‹åè°ƒ
      - ğŸ“§ **é€šçŸ¥ç³»ç»Ÿ** - å¯é çš„æ¶ˆæ¯å‘é€å’Œé‡è¯•æœºåˆ¶

      ## æŠ€æœ¯æ¶æ„

      - **Temporal Server ç‰ˆæœ¬**: 1.29.0
      - **Web UI ç‰ˆæœ¬**: 2.40.1
      - **æ•°æ®åº“**: PostgreSQL 16
      - **æ”¯æŒçš„ SDK**: Go, Java, Python, TypeScript, .NET, PHP

      ## æ³¨æ„äº‹é¡¹

      - âš ï¸ **åå°æœåŠ¡**: æœ¬åº”ç”¨ä¸ºåå°æœåŠ¡ï¼Œä¼šæŒç»­è¿è¡Œä¸ä¼šè‡ªåŠ¨ä¼‘çœ 
      - ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**: æ‰€æœ‰å·¥ä½œæµçŠ¶æ€å’Œå†å²æ•°æ®å­˜å‚¨åœ¨ PostgreSQL ä¸­ï¼Œå»ºè®®å®šæœŸå¤‡ä»½
      - ğŸ”’ **å•å®ä¾‹æ¨¡å¼**: åº”ç”¨è¿è¡Œåœ¨å•å®ä¾‹æ¨¡å¼ï¼Œé€‚åˆä¸­å°è§„æ¨¡ä½¿ç”¨åœºæ™¯
      - ğŸŒ **ç½‘ç»œè®¿é—®**: Worker å¯ä»¥éƒ¨ç½²åœ¨ä»»ä½•èƒ½è®¿é—® LazyCat å¹³å°çš„ç¯å¢ƒä¸­

      ## ç›¸å…³èµ„æº

      - ğŸ“– [Temporal å®˜æ–¹æ–‡æ¡£](https://docs.temporal.io/)
      - ğŸ’» [Go SDK æ–‡æ¡£](https://docs.temporal.io/dev-guide/go)
      - ğŸ“¦ [ç¤ºä¾‹ä»£ç åº“](https://github.com/temporalio/samples-go)
      - ğŸ™ [é¡¹ç›® GitHub](https://github.com/lazycatapps/temporal)

  en:
    name: Temporal Workflow Engine
    description: |
      ## Temporal Workflow Engine

      Temporal official website: https://temporal.io/

      Temporal is an open-source distributed workflow orchestration platform designed for building reliable and scalable distributed applications. Through the concepts of Workflows and Activities, it helps developers easily implement complex business process orchestration.

      This application deploys a complete Temporal service on the LazyCat platform, including Temporal Server, Web UI, PostgreSQL database, and admin tools, ready to use out of the box.

      ## Core Features

      - âœ… **Automatic Retry Mechanism** - Activities automatically retry on failure without manual retry logic
      - âœ… **Execution Integrity Guarantee** - Workflows resume from interruption points even after service restarts
      - âœ… **Long-Running Support** - Supports workflow execution times from seconds to years
      - âœ… **Distributed Transactions** - Provides Saga pattern for simplified distributed transaction handling
      - âœ… **Observability** - Built-in Web UI to view workflow execution history and status
      - âœ… **Horizontal Scaling** - Workers can scale horizontally to increase processing capacity

      ## Main Components

      - **Temporal Server** - Core workflow engine service (gRPC port 7233)
      - **Web UI** - Workflow management and monitoring interface (accessible via application domain)
      - **PostgreSQL** - Persistent storage for workflow state and history
      - **Admin Tools** - Command-line management tools

      ## Usage Instructions

      ### 1. Access Web UI

      Access the Temporal Web UI directly through the application domain to view and manage workflow executions:
      ```
      https://temporal.${BOXNAME}.heiyu.space
      ```

      ### 2. Connect to Temporal Service

      Use the Temporal Go SDK in your application to connect to the service:
      ```go
      import "go.temporal.io/sdk/client"

      c, err := client.Dial(client.Options{
          HostPort: "temporal.${BOXNAME}.heiyu.space:7233",
      })
      ```

      ### 3. Run Example Project

      This repository includes a complete order processing system example (order-demo) demonstrating:
      - 5-step order processing flow (Validation â†’ Inventory â†’ Payment â†’ Shipping â†’ Notification)
      - Automatic retry mechanism
      - Compensating transactions (Saga pattern)
      - Fault tolerance handling

      Start Worker:
      ```bash
      cd order-demo
      go run worker/main.go -temporal-address temporal.${BOXNAME}.heiyu.space:7233
      ```

      Run Client:
      ```bash
      go run client/main.go -temporal-address temporal.${BOXNAME}.heiyu.space:7233
      ```

      ## Use Cases

      - ğŸ“¦ **Order Processing** - E-commerce order orchestration from creation to completion
      - ğŸ’° **Payment Processing** - Complex payment flows and refund compensation logic
      - ğŸ“Š **Data Processing** - ETL processes, batch data processing tasks
      - ğŸ”„ **Scheduled Tasks** - Complex scheduled task scheduling and retry
      - ğŸ¯ **Microservice Orchestration** - Business process coordination across multiple microservices
      - ğŸ“§ **Notification System** - Reliable message sending and retry mechanism

      ## Technical Architecture

      - **Temporal Server Version**: 1.29.0
      - **Web UI Version**: 2.40.1
      - **Database**: PostgreSQL 16
      - **Supported SDKs**: Go, Java, Python, TypeScript, .NET, PHP

      ## Important Notes

      - âš ï¸ **Background Service**: This application is a background service and will run continuously without automatic sleep
      - ğŸ’¾ **Data Persistence**: All workflow state and history data is stored in PostgreSQL, regular backups recommended
      - ğŸ”’ **Single Instance Mode**: Application runs in single instance mode, suitable for small to medium scale scenarios
      - ğŸŒ **Network Access**: Workers can be deployed in any environment that can access the LazyCat platform

      ## Related Resources

      - ğŸ“– [Temporal Official Documentation](https://docs.temporal.io/)
      - ğŸ’» [Go SDK Documentation](https://docs.temporal.io/dev-guide/go)
      - ğŸ“¦ [Sample Code Repository](https://github.com/temporalio/samples-go)
      - ğŸ™ [Project GitHub](https://github.com/lazycatapps/temporal)

# è½¯ä»¶æœ¬èº«çš„ license
license: https://choosealicense.com/licenses/mit/

# è½¯ä»¶çš„ä¸»é¡µ,ä¼šåœ¨å•†åº—ç­‰åœ°æ–¹ä½“ç°
homepage: https://github.com/temporalio/temporal

# lpk çš„ä½œè€…,ä¼šåœ¨å•†åº—ç­‰åœ°æ–¹ä½“ç°
author: liu

# ========== åº”ç”¨æ ¸å¿ƒé…ç½® ==========
application:
  subdomain: temporal # åº”ç”¨è®¿é—®å­åŸŸå
  background_task: true
  multi_instance: false # å•å®ä¾‹æ¨¡å¼

  # HTTP è·¯ç”±é…ç½® - Temporal Web UI
  routes:
    # æ ¹è·¯å¾„è½¬å‘åˆ° Temporal UI æœåŠ¡
    # ç®€åŒ–æ ¼å¼,åœ¨åº”ç”¨å†…éƒ¨ç›´æ¥ä½¿ç”¨æœåŠ¡å
    - /=http://temporal-ui:8080/

  # TCP æœåŠ¡é…ç½® - Temporal gRPC ç«¯å£
  ingress:
    - protocol: tcp
      port: 7233 # Temporal Server gRPC ç«¯å£
      service: temporal # è½¬å‘åˆ° temporal æœåŠ¡
      description: Temporal gRPC æœåŠ¡
      publish_port: "7233" # å¯¹å¤–æš´éœ²çš„ç«¯å£å·

# ========== å®¹å™¨æœåŠ¡é…ç½® ==========
services:
  # PostgreSQL æ•°æ®åº“æœåŠ¡
  postgresql:
    # é•œåƒè¯´æ˜:
    # lzc-cli appstore copy-image postgres:16
    image: registry.lazycat.cloud/liu/library/postgres:e431984486fa39d6
    environment:
      - POSTGRES_PASSWORD=temporal # æ•°æ®åº“å¯†ç 
      - POSTGRES_USER=temporal # æ•°æ®åº“ç”¨æˆ·å
    binds:
      # æ•°æ®æŒä¹…åŒ–ç›®å½•æ˜ å°„
      - /lzcapp/var/data:/var/lib/postgresql/data

  # Temporal Server æ ¸å¿ƒæœåŠ¡
  temporal:
    # é•œåƒè¯´æ˜:
    # https://hub.docker.com/r/temporalio/auto-setup/tags
    # lzc-cli appstore copy-image temporalio/auto-setup:1.29.0
    image: registry.lazycat.cloud/liu/temporalio/auto-setup:512a0cc0f32933cb

    # å¯åŠ¨å‰é…ç½®è„šæœ¬
    # æ³¨æ„:æ¯æ¬¡å®¹å™¨å¯åŠ¨éƒ½ä¼šæ‰§è¡Œ,éœ€è¦å¹‚ç­‰æ€§
    setup_script: |
      mkdir -p /configs/dynamicconfig
      cp /lzcapp/pkg/content/development-sql.yaml /configs/dynamicconfig/development-sql.yaml

    environment:
      # æ•°æ®åº“é…ç½®
      - DB=postgres12 # æ•°æ®åº“ç±»å‹
      - DB_PORT=5432 # æ•°æ®åº“ç«¯å£
      - POSTGRES_USER=temporal # æ•°æ®åº“ç”¨æˆ·å
      - POSTGRES_PWD=temporal # æ•°æ®åº“å¯†ç 
      - POSTGRES_SEEDS=postgresql # æ•°æ®åº“æœåŠ¡å
      # Temporal é…ç½®
      - DYNAMIC_CONFIG_FILE_PATH=/configs/dynamicconfig/development-sql.yaml
      - TEMPORAL_ADDRESS=temporal:7233 # Temporal Server åœ°å€
      - TEMPORAL_CLI_ADDRESS=temporal:7233 # Temporal CLI åœ°å€
    depends_on:
      - postgresql # ä¾èµ– PostgreSQL æœåŠ¡
    binds:
      # é…ç½®æ–‡ä»¶æŒä¹…åŒ–ç›®å½•
      - /lzcapp/var/configs:/configs

  # Temporal ç®¡ç†å·¥å…·æœåŠ¡
  temporal-admin-tools:
    # é•œåƒè¯´æ˜:
    # https://hub.docker.com/r/temporalio/admin-tools/tags
    # lzc-cli appstore copy-image temporalio/admin-tools:1.29
    image: registry.lazycat.cloud/liu/temporalio/admin-tools:67a1365073febb90
    environment:
      - TEMPORAL_ADDRESS=temporal:7233 # Temporal Server åœ°å€
      - TEMPORAL_CLI_ADDRESS=temporal:7233 # Temporal CLI åœ°å€
    depends_on:
      - temporal # ä¾èµ– Temporal Server æœåŠ¡

  # Temporal Web UI æœåŠ¡
  temporal-ui:
    # é•œåƒè¯´æ˜:
    # https://github.com/temporalio/ui
    # lzc-cli appstore copy-image temporalio/ui:2.40.1
    image: registry.lazycat.cloud/liu/temporalio/ui:6336c63f87b91488
    environment:
      - TEMPORAL_ADDRESS=temporal:7233 # Temporal Server åœ°å€
      - TEMPORAL_CORS_ORIGINS=http://localhost:3000,https://${LAZYCAT_APP_DOMAIN} # CORS è·¨åŸŸé…ç½®,ä½¿ç”¨ç³»ç»Ÿè‡ªåŠ¨æ³¨å…¥çš„åº”ç”¨åŸŸå
    depends_on:
      - temporal # ä¾èµ– Temporal Server æœåŠ¡
